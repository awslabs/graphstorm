# Multi-task learning example yaml files
This folder presents example yaml configurations for multi-task learning tasks. The configurations include:

  * ``ml_lp_rnf.yaml`` defines a multi-task learning task with 2 self-supervised tasks: i/ a link prediction task on ``(user, rating, movie)`` edges, and ii/ a node feature reconstruction task on the ``title`` feature of ``movie`` nodes. It uses a single-layer RGCN model as its graph encoder.

  * ``ml_nc_ec_er_lp.yaml`` defines a multi-task learning task with 6 tasks: i/ a node classification on the ``movie`` nodes with the label field as ``label``, ii/ a node classification on the ``movie`` nodes with the label field as ``label2``, iii/ an edge classification task on the ``(user, rating, movie)`` edges with the label field as ``rate_class``, iv/ an edge regression task on the ``(user, rating, movie)`` edges with the label field as ``rate``, v/ a link prediction task on the ``(user, rating, movie)`` edges, and vi/ a node feature reconstruction task on the ``title`` feature of ``movie`` nodes. These tasks are associated with specific train/validation/test masks. It uses a single-layer RGCN model as its graph encoder.

  * ``ml_nc_lp_norm.yaml`` defines a multi-task learning task with 2 tasks: i/ a node classification on the ``movie`` nodes with the label field as ``label``, ii/ a link prediction task on ``(user, rating, movie)`` edges. It uses a single-layer RGCN model as its graph encoder. The output embedding of the second task will be normalized as it is using contrastive loss.

The example inference configurations are in ``inference_scripts/mt_infer/README``.

The following example script shows how to launch a GraphStorm multitask learning training task.
You may need to change the arguments according to your tasks.
For more detials about multitask learning please refer to https://graphstorm.readthedocs.io/en/latest/advanced/multi-task-learning.html.

```
python3 -m graphstorm.run.gs_multi_task_learning \
	--workspace graphstorm/training_scripts/gsgnn_mt  \
	--num-trainers 1 \
	--num-servers 1 \
	--part-config movielen_100k_multi_task_train_val_1p_4t/movie-lens-100k.json \
	--cf ml_nc_ec_er_lp.yaml \
	--save-model-path /data/gsgnn_mt/ \
	--save-model-frequency 1000
```

The script loads a paritioned graph from ``/data/movielen_100k_multi_task_train_val_1p_4t/movie-lens-100k.json`` and saves the trained model in ``/data/gsgnn_mt/``.

Note: All example movielens graph data are generated by ``tests/end2end-tests/create_data.sh``.
